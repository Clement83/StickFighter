
const byte arene[] PROGMEM = {88,48,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x62,0x7,0xFF,0xFF,0xFC,0x3,0xFF,0xFF,0xFE,0xC,0xE0,0x56,0x4,0x4,0x4,0x4,0x2,0x2,0x2,0x2,0xA,0x20,0x62,0x4,0x4,0x4,0x4,0x2,0x2,0x2,0x2,0xC,0xE0,0x42,0x4,0x4,0x4,0x4,0x2,0x2,0x2,0x2,0x8,0x80,0x47,0x7,0xFF,0xFF,0xFC,0x3,0xFF,0xFF,0xFE,0x8,0xE0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x31,0x8C,0x0,0x0,0x0,0x0,0x0,0x0,0x3,0x18,0xC0,0x4A,0x52,0x0,0x0,0x0,0x0,0x0,0x0,0x4,0xA5,0x20,0x4A,0x52,0x0,0x0,0x0,0x0,0x0,0x0,0x4,0xA5,0x20,0x31,0x8C,0x0,0x0,0x0,0x0,0x0,0x0,0x3,0x18,0xC0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xF0,0x80,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x10,0x80,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x10,0x80,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x10,0xD5,0x55,0x55,0x55,0x55,0x55,0x55,0x55,0x55,0x55,0x50,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xF0,};

const byte cptBold1[] PROGMEM = {8,12,0x18,0x28,0x48,0xA8,0xE8,0xE8,0x28,0x28,0xEC,0x84,0xFC,0xFC,};
const byte cptBold2[] PROGMEM = {8,12,0xFC,0x84,0xF4,0xF4,0xF4,0x84,0xBC,0xBC,0xBC,0x84,0xFC,0xFC,};
const byte cptBold3[] PROGMEM = {8,12,0xFC,0x84,0xF4,0xF4,0xF4,0x84,0xF4,0xF4,0xF4,0x84,0xFC,0xFC,};
const byte fight[] PROGMEM = {32,12,0xFD,0xF7,0xEF,0xDF,0x85,0x14,0x2B,0x51,0xBD,0xB5,0xEB,0x5B,0xBD,0xB5,0xEB,0x5B,0xBC,0xA5,0xB,0x4A,0x84,0xA5,0xE8,0x4A,0xBC,0xA5,0x2B,0x4A,0xBC,0xA5,0xAB,0x4A,0xA0,0xA5,0xAB,0x4A,0xA1,0x14,0x2B,0x4A,0xE1,0xF7,0xEF,0xCE,0xE1,0xF7,0xEF,0xCE,};

const byte timeUp[] PROGMEM = {48,12,0xFB,0xEF,0xDF,0x80,0x7E,0xFC,0x8A,0x28,0x50,0x80,0x5A,0x84,0xDB,0x68,0x57,0x80,0x5A,0xB4,0xDB,0x68,0x57,0x80,0x5A,0xB4,0x51,0x4B,0x57,0x80,0x5A,0x84,0x51,0x4B,0x50,0x80,0x5A,0xBC,0x51,0x4B,0x57,0x80,0x5A,0xBC,0x51,0x4B,0x57,0x80,0x5A,0xA0,0x51,0x4B,0x57,0x80,0x5A,0xA0,0x52,0x2B,0x50,0x80,0x42,0xA0,0x73,0xEF,0xDF,0x80,0x7E,0xE0,0x73,0xEF,0xDF,0x80,0x7E,0xE0,};


byte const * tabCpt[4] = {fight,cptBold1,cptBold2,cptBold3}; 

unsigned int cptTechArena;
uint8_t xoffsetCptGras;
uint8_t yoffsetTimeUp;

void initArena()
{
 cptCombat = CPT_COMBAT_INIT;
 cptTechArena = 80;
 stateFight = 0;
 xoffsetCptGras = 0;
 yoffsetTimeUp = 0;
}

void updateArena()
{
  if(cptTechArena>0) cptTechArena--;
  if(stateFight == 0)
  {
    if(cptTechArena == 19)
    {
      xoffsetCptGras = 13;
    }
    else if(cptTechArena == 0)
    {
      stateFight = 1;
    }
  }
  if(stateFight == 1 && cptCombat == 0)
  {
    stateFight = 3;
    cptTechArena = 60;
  }
  
  if(stateFight == 1)
  {  
    if(gb.frameCount%20 == 0) cptCombat--;
  }
  
  if(stateFight == 3)
  {
    if(cptTechArena >= 30 )
    {
      yoffsetTimeUp = cptTechArena-30;
    }
    if(cptTechArena ==0 )
    {
      restartCombat();
    }
  }
}


void drawArena()
{
  gb.display.drawBitmap(0,0,arene);
  switch(stateFight)
  {
    case 0 :
       //3, 2, 1 Fight! 

       gb.display.drawBitmap(39-xoffsetCptGras,18,tabCpt[((uint8_t)cptTechArena/20)]);

    break;
    case 1 :
       //Fight 
       displayInt(cptCombat,38,1,2);
    break;
    case 2 :
       //Figther KO 
    break;
    case 3 :
       //Time UP 
       gb.display.drawBitmap(21,18 + yoffsetTimeUp,timeUp);
    break;
  }
}

void restartCombat()
{
  initPlayer();
  initArena();
}


